$(function(){$(".switch-button").on("click",function(r){r.preventDefault(),$(this).closest("form").toggle(),$(this).closest("form").siblings("form").toggle(),$(this).closest("form").find("p.success, p.error").remove(""),$(this).closest("form").find(".error").removeClass("error"),$(this).closest("form").find("input").val("")}),$(".register-button").on("click",function(r){r.preventDefault();var o=this,e={login:$("#register-login").val(),password:$("#register-password").val(),passwordConfirm:$("#register-password-confirm").val()};$.ajax({type:"POST",data:JSON.stringify(e),contentType:"application/json",url:"/api/auth/register"}).done(function(r){if($("p.error, p.success").remove(),!r.ok)return $(".register h2").after('<p class="error">'+r.error+"</p>"),void(r.fields&&r.fields.forEach(function(r){$(o).closest("form").find('input[name="'+r+'"]').addClass("error")}));$(".register h2").after('<p class="success">Отлично</p>')})}),$(".login-button").on("click",function(r){r.preventDefault();var o=this,e={login:$("#login-login").val(),password:$("#login-password").val()};$.ajax({type:"POST",data:JSON.stringify(e),contentType:"application/json",url:"/api/auth/login"}).done(function(r){if($("p.error, p.success").remove(),!r.ok)return $(".login h2").after('<p class="error">'+r.error+"</p>"),void(r.fields&&r.fields.forEach(function(r){$(o).closest("form").find('input[name="login-'+r+'"]').addClass("error")}));location.href="/"})}),$("input, textarea").on("focus",function(){$("input").removeClass("error"),$("p.error").remove()})});